# Megaplan API v3 - Краткое описание

Base URL: `http://megaplan.lds.online/api/v3`

## Аутентификация
- Все запросы должны содержать заголовок `Authorization: Bearer <token>`
- Системный токен имеет расширенные права
- При использовании системного токена можно создавать сущности от имени других пользователей

## Основные эндпоинты

### 1. Управление аккаунтом
- `/account` - управление аккаунтом
  - GET: получение информации
  - POST: обновление настроек
- `/accountInfo` - информация об аккаунте
  - GET: получение детальной информации
- `/accountOrder` - заказы и тарификация
  - GET: список заказов
  - POST: создание заказа
- `/accountDoc` - документы аккаунта
  - GET: получение документов
  - POST: загрузка документов

### 2. Контрагенты
- `/contractor` - общий API для контрагентов
  - GET: получение списка
  - POST: создание
  - PUT: обновление
- `/contractorCompany` - компании
  - GET: список компаний
  - POST: создание компании
  - `/search`: поиск компаний
  - `/tags`: теги компаний
- `/contractorHuman` - физические лица
  - GET: список физлиц
  - POST: создание контакта
  - `/search`: поиск контактов
  - `/tags`: теги контактов
- `/contractorImport` - импорт контактов
  - POST: импорт данных

### 3. CRM и сделки
- `/deal` - управление сделками
  - GET: список сделок
  - POST: создание сделки
  - `/checkDealExist`: проверка существования
  - `/duplicates`: поиск дубликатов
- `/crmFilter` - фильтры CRM
  - GET: получение фильтров
  - `/export`: экспорт данных
- `/customCrmFilter` - пользовательские фильтры
  - GET: список фильтров
  - POST: создание фильтра

### 4. Коммуникации
- `/chat` - чаты
  - GET: список чатов
  - POST: создание чата
  - `/participants`: участники
  - `/sound`: настройки звука
- `/callInfo` - телефония
  - GET: информация о звонках
  - `/history`: история звонков
- `/conference` - конференции
  - `/join`: присоединиться
  - `/leave`: покинуть
  - `/decline`: отклонить

### 5. Документы
- `/attache` - вложения и файлы
  - GET: получение файлов
  - POST: загрузка файлов
- `/consignment` - накладные
  - GET: список накладных
  - POST: создание накладной
- `/invoice` - счета
  - GET: список счетов
  - POST: создание счета

### 6. Дополнительные функции
- `/autocomplete` - автодополнение
  - `/anyTypes`: поиск по всем типам
  - `/mentions`: упоминания
- `/burning` - горящие задачи
  - GET: список задач
  - `/counter`: счетчик задач
- `/approval` - согласования
  - GET: список согласований
  - POST: создание согласования
- `/counter` - счетчики уведомлений

### 7. Задачи и события
- `/task` - управление задачами
  - POST: создание задачи
    ```json
    {
      "name": "Название задачи",
      "owner": {
        "id": "1234567",  // ID владельца задачи
        "contentType": "Employee"
      },
      "responsible": {
        "id": "1234567",  // ID ответственного
        "contentType": "Employee"
      },
      "isUrgent": false,
      "deadline": "2024-01-10T15:00:00.000Z",
      "status": "new",
      "description": "Описание задачи"
    }
    ```
  - GET: получение списка задач
  - PUT: обновление задачи
  - DELETE: удаление задачи

### 8. Получение информации о пользователях
- `/employee` - управление сотрудниками
  - GET: получение списка всех сотрудников
    ```
    GET /employee
    ```
  - Поиск по имени:
    ```
    GET /employee?q=Иванов
    ```
  
- `/currentUser` - информация о текущем пользователе
  - GET: получение информации о себе
    ```json
    {
      "id": "1234567",
      "contentType": "Employee",
      "name": "Иван Иванов",
      "email": "ivan@example.com",
      "position": "Менеджер"
    }
    ```

- `/autocomplete/groupEmployees` - быстрый поиск сотрудников
  - GET: поиск с автодополнением
    ```
    GET /autocomplete/groupEmployees?q=Иван
    ```
  - Возвращает список сотрудников с их ID

## Общие параметры
- Все запросы требуют авторизации
- Поддерживаемые методы: GET, POST, PUT, DELETE
- Формат данных: JSON
- Поддержка фильтрации и пагинации
- Возможность получения связанных данных 

## Примеры запросов для получения ID пользователя

1. Поиск по имени:
```
GET /employee?q=Иванов
```

2. Получение списка всех сотрудников:
```
GET /employee
```

3. Быстрый поиск через автодополнение:
```
GET /autocomplete/groupEmployees?q=Иван
```

4. Получение информации о текущем пользователе:
```
GET /currentUser
``` 